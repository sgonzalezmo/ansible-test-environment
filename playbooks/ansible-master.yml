---
- hosts: all
  become: true
  tasks:
    - name: add repository
      yum_repository:
        name: epel
        description: EPEL YUM repo
        baseurl: https://download.fedoraproject.org/pub/epel/$releasever/$basearch/
        gpgkey: https://getfedora.org/static/352C64E5.txt
    - name: install the latest version of ansible
      yum:
        name: ansible
        state: latest
    - name: validate ansible installation
      shell: ansible --version
    - name: create ansible user and ssh key
      user:
        name: ansible
        password: ansible
        comment: "ansible user"
        generate_ssh_key: yes
        ssh_key_bits: 2048
    - name: downloading ansible user pub key
      fetch: src=/home/ansible/.ssh/id_rsa.pub dest=tmp/id_rsa.tmp flat=yes